# ArtSlave æµ‹è¯•æ¡†æ¶

## ğŸ“‹ æ¦‚è¿°

ArtSlave é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•æ¡†æ¶ï¼Œæ¶µç›–å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•ï¼Œç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚

## ğŸ§ª æµ‹è¯•ç±»å‹

### 1. å•å…ƒæµ‹è¯• (Unit Tests)
- **æ–‡ä»¶**: `tests/components.test.tsx`
- **æ¡†æ¶**: Jest + React Testing Library
- **è¦†ç›–èŒƒå›´**: React ç»„ä»¶ã€å·¥å…·å‡½æ•°ã€ä¸šåŠ¡é€»è¾‘

### 2. é›†æˆæµ‹è¯• (Integration Tests)
- **æ–‡ä»¶**: `tests/integration-test.js`
- **æ¡†æ¶**: Node.js + Fetch API
- **è¦†ç›–èŒƒå›´**: API ç«¯ç‚¹ã€æ•°æ®åº“æ“ä½œã€ç³»ç»Ÿé›†æˆ

### 3. Python çˆ¬è™«æµ‹è¯•
- **æ–‡ä»¶**: `crawler/test_crawler.py`
- **æ¡†æ¶**: Python unittest
- **è¦†ç›–èŒƒå›´**: çˆ¬è™«ç®¡ç†å™¨ã€æ•°æ®åº“è¿æ¥ã€è°ƒåº¦å™¨

## ğŸš€ è¿è¡Œæµ‹è¯•

### å®‰è£…ä¾èµ–
```bash
npm install
```

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
npm run test:all
```

### è¿è¡Œå•å…ƒæµ‹è¯•
```bash
npm run test
```

### è¿è¡Œé›†æˆæµ‹è¯•
```bash
npm run test:integration
```

### è¿è¡Œæµ‹è¯•è¦†ç›–ç‡
```bash
npm run test:coverage
```

### ç›‘è§†æ¨¡å¼è¿è¡Œæµ‹è¯•
```bash
npm run test:watch
```

### CI/CD æµ‹è¯•
```bash
npm run test:ci
```

## ğŸ“Š æµ‹è¯•è¦†ç›–ç‡

ç›®æ ‡è¦†ç›–ç‡ï¼š
- **åˆ†æ”¯è¦†ç›–ç‡**: 70%
- **å‡½æ•°è¦†ç›–ç‡**: 70%
- **è¡Œè¦†ç›–ç‡**: 70%
- **è¯­å¥è¦†ç›–ç‡**: 70%

## ğŸ”§ æµ‹è¯•é…ç½®

### Jest é…ç½® (`jest.config.js`)
- æµ‹è¯•ç¯å¢ƒ: jsdom
- æ¨¡å—æ˜ å°„: `@/` â†’ `src/`
- è¦†ç›–ç‡æ”¶é›†: `src/**/*.{js,jsx,ts,tsx}`
- æµ‹è¯•è¶…æ—¶: 10ç§’

### æµ‹è¯•è®¾ç½® (`jest.setup.js`)
- å…¨å±€ Mock: IntersectionObserver, ResizeObserver, matchMedia
- å­˜å‚¨ Mock: localStorage, sessionStorage
- æ§åˆ¶å°è­¦å‘ŠæŠ‘åˆ¶

## ğŸ“ æµ‹è¯•ç”¨ä¾‹

### React ç»„ä»¶æµ‹è¯•

#### HomePage
- âœ… æ¸²æŸ“ä¸»è¦å¯¼èˆªå¡ç‰‡
- âœ… æ˜¾ç¤ºç»Ÿè®¡æ•°æ®
- âœ… ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½

#### SubmissionsPage
- âœ… æ¸²æŸ“æŠ•ç¨¿åˆ—è¡¨
- âœ… æœç´¢åŠŸèƒ½
- âœ… ç±»å‹ç­›é€‰
- âœ… åˆ†é¡µåŠŸèƒ½

#### DataCollectionPage
- âœ… æ•°æ®æºç®¡ç†ç•Œé¢
- âœ… è°ƒåº¦å™¨çŠ¶æ€æ˜¾ç¤º
- âœ… n8n é›†æˆæ§åˆ¶
- âœ… çˆ¬è™«å¯åŠ¨/åœæ­¢

#### DataManagementPage
- âœ… æ•°æ®åº“ç®¡ç†ç•Œé¢
- âœ… CRUD æ“ä½œ
- âœ… è¡¨å•éªŒè¯

### API ç«¯ç‚¹æµ‹è¯•

#### /api/submissions
- âœ… GET: è·å–æŠ•ç¨¿åˆ—è¡¨
- âœ… POST: åˆ›å»ºæ–°æŠ•ç¨¿
- âœ… PUT: æ›´æ–°æŠ•ç¨¿
- âœ… DELETE: åˆ é™¤æŠ•ç¨¿

#### /api/datasources
- âœ… GET: è·å–æ•°æ®æºåˆ—è¡¨
- âœ… POST: åˆ›å»ºæ•°æ®æº
- âœ… PUT: æ›´æ–°æ•°æ®æº
- âœ… DELETE: åˆ é™¤æ•°æ®æº

#### /api/crawler
- âœ… GET: è·å–çˆ¬è™«çŠ¶æ€
- âœ… POST: å¯åŠ¨çˆ¬è™«

#### /api/scheduler
- âœ… GET: è·å–è°ƒåº¦å™¨çŠ¶æ€
- âœ… POST: æ§åˆ¶è°ƒåº¦å™¨

#### /api/n8n
- âœ… GET: è·å– n8n çŠ¶æ€
- âœ… POST: æ§åˆ¶ n8n æœåŠ¡

### ç³»ç»Ÿé›†æˆæµ‹è¯•

#### åŸºç¡€åŠŸèƒ½
- âœ… ä¸»é¡µè®¿é—®
- âœ… æ–‡ä»¶ç³»ç»Ÿç»“æ„
- âœ… æ•°æ®åº“è¿æ¥
- âœ… Python çˆ¬è™«ç³»ç»Ÿ

#### æ•°æ®åº“æ“ä½œ
- âœ… CRUD æ“ä½œå®Œæ•´æ€§
- âœ… æ•°æ®éªŒè¯
- âœ… é”™è¯¯å¤„ç†

#### æ€§èƒ½æµ‹è¯•
- âœ… å¹¶å‘è¯·æ±‚å¤„ç†
- âœ… å“åº”æ—¶é—´æµ‹è¯•
- âœ… èµ„æºä½¿ç”¨ç›‘æ§

## ğŸ› é”™è¯¯å¤„ç†æµ‹è¯•

### ç½‘ç»œé”™è¯¯
- âœ… API è¯·æ±‚å¤±è´¥å¤„ç†
- âœ… è¶…æ—¶å¤„ç†
- âœ… ç½‘ç»œä¸­æ–­æ¢å¤

### æ•°æ®é”™è¯¯
- âœ… æ— æ•ˆæ•°æ®æ ¼å¼
- âœ… ç¼ºå¤±å­—æ®µå¤„ç†
- âœ… ç±»å‹é”™è¯¯å¤„ç†

### ç”¨æˆ·é”™è¯¯
- âœ… è¡¨å•éªŒè¯
- âœ… æƒé™æ£€æŸ¥
- âœ… è¾“å…¥æ¸…ç†

## ğŸ“ˆ æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•è¿è¡Œåä¼šç”Ÿæˆä»¥ä¸‹æŠ¥å‘Šï¼š

### è¦†ç›–ç‡æŠ¥å‘Š
- **ä½ç½®**: `coverage/lcov-report/index.html`
- **å†…å®¹**: è¯¦ç»†çš„ä»£ç è¦†ç›–ç‡åˆ†æ

### é›†æˆæµ‹è¯•æŠ¥å‘Š
- **ä½ç½®**: `tests/test-report.json`
- **å†…å®¹**: 
  ```json
  {
    "timestamp": "2025-01-11T10:00:00.000Z",
    "results": {
      "total": 15,
      "passed": 14,
      "failed": 1,
      "errors": [...]
    },
    "successRate": 93.3,
    "environment": {
      "nodeVersion": "v18.17.0",
      "platform": "win32",
      "baseUrl": "http://localhost:3000"
    }
  }
  ```

## ğŸ”„ æŒç»­é›†æˆ

### GitHub Actions é…ç½®
```yaml
name: Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm install
      - run: npm run test:ci
```

### æµ‹è¯•æµæ°´çº¿
1. **ä»£ç æ£€æŸ¥**: ESLint + TypeScript
2. **å•å…ƒæµ‹è¯•**: Jest + React Testing Library
3. **é›†æˆæµ‹è¯•**: API ç«¯ç‚¹æµ‹è¯•
4. **è¦†ç›–ç‡æ£€æŸ¥**: æœ€ä½ 70% è¦†ç›–ç‡
5. **æ€§èƒ½æµ‹è¯•**: å“åº”æ—¶é—´éªŒè¯

## ğŸ› ï¸ æµ‹è¯•å·¥å…·

### å‰ç«¯æµ‹è¯•
- **Jest**: JavaScript æµ‹è¯•æ¡†æ¶
- **React Testing Library**: React ç»„ä»¶æµ‹è¯•
- **@testing-library/jest-dom**: DOM æ–­è¨€æ‰©å±•
- **@testing-library/user-event**: ç”¨æˆ·äº¤äº’æ¨¡æ‹Ÿ

### åç«¯æµ‹è¯•
- **Node.js**: é›†æˆæµ‹è¯•è¿è¡Œç¯å¢ƒ
- **node-fetch**: HTTP è¯·æ±‚æµ‹è¯•
- **Python unittest**: Python çˆ¬è™«æµ‹è¯•

### Mock å·¥å…·
- **Jest Mocks**: å‡½æ•°å’Œæ¨¡å— Mock
- **MSW**: API Mock æœåŠ¡
- **Test Fixtures**: æµ‹è¯•æ•°æ®ç”Ÿæˆ

## ğŸ“š æœ€ä½³å®è·µ

### æµ‹è¯•ç¼–å†™åŸåˆ™
1. **AAA æ¨¡å¼**: Arrange, Act, Assert
2. **å•ä¸€èŒè´£**: æ¯ä¸ªæµ‹è¯•åªéªŒè¯ä¸€ä¸ªåŠŸèƒ½
3. **ç‹¬ç«‹æ€§**: æµ‹è¯•ä¹‹é—´ä¸ç›¸äº’ä¾èµ–
4. **å¯è¯»æ€§**: æ¸…æ™°çš„æµ‹è¯•åç§°å’Œæè¿°

### æµ‹è¯•æ•°æ®ç®¡ç†
1. **ä½¿ç”¨ Mock æ•°æ®**: é¿å…ä¾èµ–çœŸå®æ•°æ®
2. **æ•°æ®éš”ç¦»**: æ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹æ•°æ®
3. **æ¸…ç†æœºåˆ¶**: æµ‹è¯•åæ¸…ç†ä¸´æ—¶æ•°æ®

### æ€§èƒ½ä¼˜åŒ–
1. **å¹¶è¡Œæ‰§è¡Œ**: åˆ©ç”¨ Jest å¹¶è¡Œèƒ½åŠ›
2. **é€‰æ‹©æ€§è¿è¡Œ**: åªè¿è¡Œç›¸å…³æµ‹è¯•
3. **ç¼“å­˜åˆ©ç”¨**: å¤ç”¨æµ‹è¯•ç¯å¢ƒè®¾ç½®

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### æµ‹è¯•è¶…æ—¶
```bash
# å¢åŠ è¶…æ—¶æ—¶é—´
jest --testTimeout=30000
```

#### æ¨¡å—è§£æé”™è¯¯
```bash
# æ£€æŸ¥ Jest é…ç½®ä¸­çš„ moduleNameMapping
```

#### React ç»„ä»¶æ¸²æŸ“é”™è¯¯
```bash
# ç¡®ä¿æ­£ç¡®å¯¼å…¥ @testing-library/jest-dom
```

### è°ƒè¯•æŠ€å·§

#### è°ƒè¯•å•ä¸ªæµ‹è¯•
```bash
npm test -- --testNamePattern="specific test name"
```

#### æŸ¥çœ‹æµ‹è¯•è¾“å‡º
```bash
npm test -- --verbose
```

#### ç”Ÿæˆè°ƒè¯•ä¿¡æ¯
```bash
npm test -- --debug
```

## ğŸ“ æ”¯æŒ

å¦‚æœ‰æµ‹è¯•ç›¸å…³é—®é¢˜ï¼š
1. æŸ¥çœ‹æµ‹è¯•æ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥æµ‹è¯•é…ç½®æ–‡ä»¶
3. å‚è€ƒ Jest å’Œ React Testing Library æ–‡æ¡£
4. æäº¤ GitHub Issue
